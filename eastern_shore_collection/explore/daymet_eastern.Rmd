---
title: "DAYMET Temperature Data"
subtitle: "Data for Eastern Shore Region"
author: "Tolu Odukoya"
date: "8/23/2021"
output: 
    html_document: 
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# 0. Load libraries and data
library(tidyverse)
library(stargazer) # for summary table
library(janitor) # for tabyl
library(tigris) # for shapefiles
library(sf) # for spatial joins
library(leaflet) # for map
library(viridis)
library(googlesheets4)
library(mapview)
library(RColorBrewer)
library(shiny)
library(shinydashboard)
library(shinythemes) # this might be for the sidebar/story widges, or just a holdover from an earlier version
library(shinyWidgets) # this might be a holdover from an earlier version of selectors?
library(rgdal)
library(operators)
library(magrittr)
library(lubridate)
library(maps)
library(magick)
library(extrafont)
library(showtext)
library('Cairo')
library(rnaturalearth)
library(kableExtra)
library(devtools)
library(xts)
library(tools)
library(zoo)
library(geosphere)
daymet1 <- read_csv("daymet_eastern_block.csv")
daymet2 <- read_csv("daymet_eastern_blkgrps.csv")
daymet3 <- read_csv("daymet_eastern_tract.csv")
easternfips <- c("001", "131")
meta <- read_sheet("https://docs.google.com/spreadsheets/d/1nqm3DuVXD1ObbVe_deacvT7uSLdBXfQJo3mkbqDwrVo/edit#gid=1573436636", sheet = "DAYMET")
```

```{r, include=FALSE}
daymet1$GEOID = as.character(daymet1$GEOID)
daymet2$GEOID = as.character(daymet2$GEOID)
daymet2$BLKGRPCE = as.character(daymet2$BLKGRPCE)
daymet3$GEOID = as.character(daymet3$GEOID)
daymet1 <-  daymet1 %>%
  dplyr::select(STATEFP, Year, COUNTYFP, NAMES, TRACTCE, BLOCKCE, GEOID, NAME, JuneF, JulyF, AugustF, Totpcpinch, everything())
daymet2 <- daymet2 %>%
  dplyr::select(STATEFP, Year, COUNTYFP, NAMES, TRACTCE, BLKGRPCE, GEOID, NAMELSAD, JuneF, JulyF, AugustF, Totpcpinch, everything())
daymet3 <- daymet3 %>%
  dplyr::select(STATEFP, Year, COUNTYFP, NAMES, TRACTCE, GEOID, NAMELSAD, JuneF, JulyF, AugustF, Totpcpinch, everything())


```

```{r, include=FALSE}
  eastern_blocks <- blocks(state = "51", county = easternfips)
  eastern_blocks <- eastern_blocks %>%
    dplyr::select(GEOID10, geometry) %>% mutate(GEOID = GEOID10)
  eastern_daymet1 <- merge(daymet1, eastern_blocks, by = 'GEOID', all.y = T)
  
  
  eastern_daymet1 <- eastern_daymet1  %>%
    dplyr::select(COUNTYFP, NAMES, GEOID, Year, NAME, JuneF, JulyF, AugustF,Totpcpinch, geometry)
  eastern_daymet1$Year = as.numeric(eastern_daymet1$Year)
  eastern_daymet1 <-  eastern_daymet1 %>% filter_at(vars(JuneF:Totpcpinch),all_vars(!is.na(.)))
  eastern_daymet1 <- st_as_sf(eastern_daymet1)
  eastern_daymet1 <- st_transform(eastern_daymet1, crs = "WGS84")

  
  eastern_blkgps <- block_groups(state = "51", county = easternfips)
  eastern_blkgps <- eastern_blkgps %>%
    dplyr::select(GEOID, geometry)
  eastern_daymet2 <- merge(daymet2, eastern_blkgps, by = 'GEOID', all.y = T)
  
  
  
  eastern_daymet2 <- eastern_daymet2  %>%
    dplyr::select(COUNTYFP, NAMES, GEOID, Year, NAMELSAD, JuneF, JulyF, AugustF,Totpcpinch, geometry)
  eastern_daymet2$Year = as.numeric(eastern_daymet2$Year)
  eastern_daymet2 <-  eastern_daymet2 %>% filter_at(vars(JuneF:Totpcpinch),all_vars(!is.na(.)))
  eastern_daymet2 <- st_as_sf(eastern_daymet2)
  eastern_daymet2 <- st_transform(eastern_daymet2, crs = "WGS84")
  
 
  eastern_tract <- tracts(state = "51", county = easternfips)
  eastern_tract <- eastern_tract %>%
    dplyr::select(GEOID, geometry)
  eastern_daymet3 <- merge(daymet3, eastern_tract, by = 'GEOID', all.y = T)
  
  
  
  eastern_daymet3 <- eastern_daymet3  %>%
    dplyr::select(COUNTYFP, NAMES, GEOID, Year, NAMELSAD, JuneF, JulyF, AugustF,Totpcpinch, geometry)
  eastern_daymet3$Year = as.numeric(eastern_daymet3$Year)
  eastern_daymet3 <-  eastern_daymet3 %>% filter_at(vars(JuneF:Totpcpinch),all_vars(!is.na(.)))
  eastern_daymet3 <- st_as_sf(eastern_daymet3)
  eastern_daymet3 <- st_transform(eastern_daymet3, crs = "WGS84")
 

```

```{r, include=FALSE}
# create GroupValuesIntoColors() function
GroupValuesIntoColors <- function( list.of.values, desired.breaks, min.color, max.color ){
  
  # check for list and for integer 
  if( !is.list( list.of.values ) ){
    stop("list.of.values is not a list.")
  } else if( !is.numeric( desired.breaks ) ){
    stop("desired.breaks is not numeric." )
  }
  
  # make colors from min.color to max.color
  color.function <- colorRampPalette( c( min.color , max.color ))
  
  # decide how many groups I want
  color.ramp <- color.function( desired.breaks )
  
  # group values into colors
  list.of.colors <- lapply( X = list.of.values
                            , FUN = function(i) 
                              as.character(
                                cut( # use cut to divide the range of i values into intervals
                                  x = rank( i ) # used to rank the values (always assigning order)
                                  , breaks = desired.breaks # define the numbers of groups to place certain values of X
                                  , labels = color.ramp # label the groups a color from color.ramp
                                )
                              )
  )
  # place 'color_' into the names of the values list.of.colors
  names( list.of.colors ) <- paste( "color"
                                    , names( list.of.values )
                                    , sep = "_"
  )
  # return list.of.colors to the Global Environment
  return( list.of.colors )
} 

```

```{r blocks, include=FALSE}

  Juneb <- subset(eastern_daymet1, JuneF & Year == "1980")
  Juneb1 <- subset(eastern_daymet1, JuneF & Year == "1990")
  Juneb2 <- subset(eastern_daymet1, JuneF & Year == "2000")
  Juneb3 <- subset(eastern_daymet1, JuneF & Year == "2010")
  Juneb4  <- subset(eastern_daymet1, JuneF & Year == "2020")
  
  
  se.valuesb <- list(Juneb$JuneF
                     , Juneb1$JuneF
                     , Juneb2$JuneF
                     , Juneb3$JuneF
                     , Juneb4$JuneF
  )
  names( se.valuesb ) <- c("June", "June", "June", "June", "June")
  
  
  se.color.valuesb <- GroupValuesIntoColors( list.of.values = se.valuesb[1]
                                             , desired.breaks = 5
                                             , min.color = "#EE82EE"
                                             , max.color = "#8B008B")
  
  
  
  se.color.valuesbj1 <- GroupValuesIntoColors( list.of.values = se.valuesb[2]
                                               , desired.breaks = 5
                                               , min.color = "#EE82EE"
                                               , max.color = "#8B008B"
  )
  
  se.color.valuesbj2 <- GroupValuesIntoColors( list.of.values = se.valuesb[3]
                                               , desired.breaks = 5
                                               , min.color = "#EE82EE"
                                               , max.color = "#8B008B"
  )
  
  se.color.valuesbj3<- GroupValuesIntoColors( list.of.values = se.valuesb[4]
                                              , desired.breaks = 5
                                              , min.color = "#EE82EE"
                                              , max.color = "#8B008B"
  )
  
  se.color.valuesbj4<- GroupValuesIntoColors( list.of.values = se.valuesb[5]
                                              , desired.breaks = 5
                                              , min.color = "#EE82EE"
                                              , max.color = "#8B008B"
  )
  
  Juneb <- cbind.data.frame(Juneb
                            , se.color.valuesb
                            , stringsAsFactors = FALSE
  )
  
  Juneb1 <- cbind.data.frame(Juneb1
                             , se.color.valuesbj1
                             , stringsAsFactors = FALSE
  )
  
  Juneb2 <- cbind.data.frame(Juneb2
                             , se.color.valuesbj2
                             , stringsAsFactors = FALSE
  )
  
  Juneb3 <- cbind.data.frame(Juneb3
                             , se.color.valuesbj3
                             , stringsAsFactors = FALSE
  )
  
  Juneb4 <- cbind.data.frame(Juneb4
                             , se.color.valuesbj4
                             , stringsAsFactors = FALSE
  )
  
  
  Juneb <- st_as_sf(Juneb)
  Juneb1 <- st_as_sf(Juneb1)
  Juneb2 <- st_as_sf(Juneb2)
  Juneb3 <- st_as_sf(Juneb3)
  Juneb4 <- st_as_sf(Juneb4)
  
  ## July 
  
  Julyb <- subset(eastern_daymet1, JulyF & Year == "1980")
  Julyb1 <- subset(eastern_daymet1, JulyF & Year == "1990")
  Julyb2 <- subset(eastern_daymet1, JulyF & Year == "2000")
  Julyb3 <- subset(eastern_daymet1, JulyF & Year == "2010")
  Julyb4  <- subset(eastern_daymet1, JulyF & Year == "2020")
  
  
  se.valuesb1 <- list(Julyb$JulyF
                      , Julyb1$JulyF
                      , Julyb2$JulyF
                      , Julyb3$JulyF
                      , Julyb4$JulyF
  )
  
  names( se.valuesb1 ) <- c("July", "July", "July", "July", "July")
  
  
  
  se.color.valuesbjl <- GroupValuesIntoColors( list.of.values = se.valuesb1[1]
                                               , desired.breaks = 5
                                               , min.color = "#FFFF00"
                                               , max.color = "#FF4500"
  )
  
  
  se.color.valuesbjl1 <- GroupValuesIntoColors( list.of.values = se.valuesb1[2]
                                                , desired.breaks = 5
                                                , min.color = "#FFFF00"
                                                , max.color = "#FF4500"
  )
  
  se.color.valuesbjl2 <- GroupValuesIntoColors( list.of.values = se.valuesb1[3]
                                                , desired.breaks = 5
                                                , min.color = "#FFFF00"
                                                , max.color = "#FF4500"
  )
  
  se.color.valuesbjl3<- GroupValuesIntoColors( list.of.values = se.valuesb1[4]
                                               , desired.breaks = 5
                                               , min.color = "#FFFF00"
                                               , max.color = "#FF4500"
  )
  
  se.color.valuesbjl4<- GroupValuesIntoColors( list.of.values = se.valuesb1[5]
                                               , desired.breaks = 5
                                               , min.color = "#FFFF00"
                                               , max.color = "#FF4500"
  )
  
  
  Julyb <- cbind.data.frame(Julyb
                            , se.color.valuesbjl
                            , stringsAsFactors = FALSE
  )
  
  Julyb1 <- cbind.data.frame(Julyb1
                             , se.color.valuesbjl1
                             , stringsAsFactors = FALSE
  )
  
  Julyb2 <- cbind.data.frame(Julyb2
                             , se.color.valuesbjl2
                             , stringsAsFactors = FALSE
  )
  
  Julyb3 <- cbind.data.frame(Julyb3
                             , se.color.valuesbjl3
                             , stringsAsFactors = FALSE
  )
  
  Julyb4 <- cbind.data.frame(Julyb4
                             , se.color.valuesbjl4
                             , stringsAsFactors = FALSE
  )
  
  Julyb <- st_as_sf(Julyb)
  Julyb1 <- st_as_sf(Julyb1)
  Julyb2 <- st_as_sf(Julyb2)
  Julyb3 <- st_as_sf(Julyb3)
  Julyb4 <- st_as_sf(Julyb4)
  
  
  
  ##August
  
  Augustb <- subset(eastern_daymet1, AugustF & Year == "1980")
  Augustb1 <- subset(eastern_daymet1, AugustF & Year == "1990")
  Augustb2 <- subset(eastern_daymet1, AugustF & Year == "2000")
  Augustb3 <- subset(eastern_daymet1, AugustF & Year == "2010")
  Augustb4  <- subset(eastern_daymet1, AugustF & Year == "2020")
  
  se.valuesb2 <- list(Augustb$AugustF
                      , Augustb1$AugustF
                      , Augustb2$AugustF
                      , Augustb3$AugustF
                      , Augustb4$AugustF
  )
  names( se.valuesb2 ) <- c("August", "August", "August", "August", "August")
  
  
  
  
  se.color.valuesba <- GroupValuesIntoColors( list.of.values = se.valuesb2[1]
                                              , desired.breaks = 5
                                              , min.color = "#ADFF2F"
                                              , max.color = "#006400"
  )
  
  
  se.color.valuesba1 <- GroupValuesIntoColors( list.of.values = se.valuesb2[2]
                                               , desired.breaks = 5
                                               , min.color = "#ADFF2F"
                                               , max.color = "#006400"
  )
  
  se.color.valuesba2 <- GroupValuesIntoColors( list.of.values = se.valuesb2[3]
                                               , desired.breaks = 5
                                               , min.color = "#ADFF2F"
                                               , max.color = "#006400"
  )
  
  se.color.valuesba3<- GroupValuesIntoColors( list.of.values = se.valuesb2[4]
                                              , desired.breaks = 5
                                              , min.color = "#ADFF2F"
                                              , max.color = "#006400"
  )
  
  se.color.valuesba4<- GroupValuesIntoColors( list.of.values = se.valuesb2[5]
                                              , desired.breaks = 5
                                              , min.color = "#ADFF2F"
                                              , max.color = "#006400"
  )
  
  Augustb <- cbind.data.frame(Augustb
                              , se.color.valuesba
                              , stringsAsFactors = FALSE
  )
  
  Augustb1 <- cbind.data.frame(Augustb1
                               , se.color.valuesba1
                               , stringsAsFactors = FALSE
  )
  
  Augustb2 <- cbind.data.frame(Augustb2
                               , se.color.valuesba2
                               , stringsAsFactors = FALSE
  )
  
  Augustb3 <- cbind.data.frame(Augustb3
                               , se.color.valuesba3
                               , stringsAsFactors = FALSE
  )
  
  Augustb4 <- cbind.data.frame(Augustb4
                               , se.color.valuesba4
                               , stringsAsFactors = FALSE
  )
  
  
  Augustb <- st_as_sf(Augustb)
  Augustb1 <- st_as_sf(Augustb1)
  Augustb2 <- st_as_sf(Augustb2)
  Augustb3 <- st_as_sf(Augustb3)
  Augustb4 <- st_as_sf(Augustb4)
  
  
  ##Precipitation
  
  Totpcpb <- subset(eastern_daymet1, Totpcpinch & Year == "1980")
  Totpcpb1 <- subset(eastern_daymet1, Totpcpinch & Year == "1990")
  Totpcpb2 <- subset(eastern_daymet1, Totpcpinch & Year == "2000")
  Totpcpb3 <- subset(eastern_daymet1, Totpcpinch & Year == "2010")
  Totpcpb4  <- subset(eastern_daymet1, Totpcpinch & Year == "2020")
  
  
  se.valuesb3 <- list(Totpcpb$Totpcpinch
                      , Totpcpb1$Totpcpinch
                      , Totpcpb2$Totpcpinch
                      , Totpcpb3$Totpcpinch
                      , Totpcpb4$Totpcpinch
  )
  names( se.valuesb3 ) <- c("Total Precipitation", "Total Precipitation", "Total Precipitation", "Total Precipitation", "Total Precipitation")
  
  
  
  se.color.valuesbt <- GroupValuesIntoColors( list.of.values = se.valuesb3[1]
                                              , desired.breaks = 5
                                              , min.color = "#ADD8E6"
                                              , max.color = "#00008B"
  )
  
  
  se.color.valuesbt1 <- GroupValuesIntoColors( list.of.values = se.valuesb3[2]
                                               , desired.breaks = 5
                                               , min.color = "#ADD8E6"
                                               , max.color = "#00008B"
  )
  
  se.color.valuesbt2 <- GroupValuesIntoColors( list.of.values = se.valuesb3[3]
                                               , desired.breaks = 5
                                               , min.color = "#ADD8E6"
                                               , max.color = "#00008B"
  )
  
  se.color.valuesbt3<- GroupValuesIntoColors( list.of.values = se.valuesb3[4]
                                              , desired.breaks = 5
                                              , min.color = "#ADD8E6"
                                              , max.color = "#00008B"
  )
  
  se.color.valuesbt4<- GroupValuesIntoColors( list.of.values = se.valuesb3[5]
                                              , desired.breaks = 5
                                              , min.color = "#ADD8E6"
                                              , max.color = "#00008B"
  )
  
  Totpcpb <- cbind.data.frame(Totpcpb
                              , se.color.valuesbt
                              , stringsAsFactors = FALSE
  )
  
  Totpcpb1 <- cbind.data.frame(Totpcpb1
                               , se.color.valuesbt1
                               , stringsAsFactors = FALSE
  )
  
  Totpcpb2 <- cbind.data.frame(Totpcpb2
                               , se.color.valuesbt2
                               , stringsAsFactors = FALSE
  )
  
  Totpcpb3 <- cbind.data.frame(Totpcpb3
                               , se.color.valuesbt3
                               , stringsAsFactors = FALSE
  )
  
  Totpcpb4 <- cbind.data.frame(Totpcpb4
                               , se.color.valuesbt4
                               , stringsAsFactors = FALSE
  )
  
  
  Totpcpb <- st_as_sf(Totpcpb)
  Totpcpb1 <- st_as_sf(Totpcpb1)
  Totpcpb2 <- st_as_sf(Totpcpb2)
  Totpcpb3 <- st_as_sf(Totpcpb3)
  Totpcpb4 <- st_as_sf(Totpcpb4)
  
  mapTitle <- paste0(
    "<p style='color:#ED7B46; font-size:14px;'>"
    , "Eastern DAYMET Temperature Data by Block, 1980, 1990, 2000, 2010, 2020"
    , "</p>"
  )
  
  
  blockmapb <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                 , dragging = TRUE
                                                
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Juneb,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Juneb$NAMES, "<br>",
                               "Block: ", Juneb$NAME, "<br>",
                               "Max Temperature: ", round(Juneb$JuneF, 2)), group = "1980 June") %>% 
    addPolygons(data = Juneb1,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Juneb1$NAMES, "<br>",
                               "Block: ", Juneb1$NAME, "<br>",
                               "Max Temperature: ", round(Juneb1$JuneF, 2)), group = "1990 June") %>% 
    addPolygons(data = Juneb2,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Juneb2$NAMES, "<br>",
                               "Block: ", Juneb2$NAME, "<br>",
                               "Max Temperature: ", round(Juneb2$JuneF, 2)), group = "2000 June") %>% 
    addPolygons(data = Juneb3,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Juneb3$NAMES, "<br>",
                               "Block: ", Juneb3$NAME, "<br>",
                               "Max Temperature: ", round(Juneb3$JuneF, 2)), group = "2010 June") %>% 
    addPolygons(data = Juneb4,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Juneb4$NAMES, "<br>",
                               "Block: ", Juneb4$NAME, "<br>",
                               "Max Temperature: ", round(Juneb4$JuneF, 2)), group = "2020 June") %>% 
    addLayersControl( baseGroups = c( "1980 June"
                                      , "1990 June"
                                      , "2000 June"
                                      , "2010 June"
                                      , "2020 June")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapb1 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                  , dragging = TRUE 
                                                 
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Julyb,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyb$NAMES, "<br>",
                               "Block: ", Julyb$NAME, "<br>",
                               "Max Temperature: ", round(Julyb$JulyF, 2)), group = "1980 July") %>% 
    addPolygons(data = Julyb1,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyb1$NAMES, "<br>",
                               "Block: ", Julyb1$NAME, "<br>",
                               "Max Temperature: ", round(Julyb1$JulyF, 2)), group = "1990 July") %>% 
    addPolygons(data = Julyb2,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyb2$NAMES, "<br>",
                               "Block: ", Julyb2$NAME, "<br>",
                               "Max Temperature: ", round(Julyb2$JulyF, 2)), group = "2000 July") %>% 
    addPolygons(data = Julyb3,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyb3$NAMES, "<br>",
                               "Block: ", Julyb3$NAME, "<br>",
                               "Max Temperature: ", round(Julyb3$JulyF, 2)), group = "2010 July") %>% 
    addPolygons(data = Julyb4,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyb4$NAMES, "<br>",
                               "Block: ", Julyb4$NAME, "<br>",
                               "Max Temperature: ", round(Julyb4$JulyF, 2)), group = "2020 July") %>% 
    addLayersControl( baseGroups = c( "1980 July"
                                      , "1990 July"
                                      , "2000 July"
                                      , "2010 July"
                                      , "2020 July")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapb2 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                  , dragging = TRUE
                                                 
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Augustb,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustb$NAMES, "<br>",
                               "Block: ", Augustb$NAME, "<br>",
                               "Max Temperature: ", round(Augustb$AugustF, 2)), group = "1980 August") %>% 
    addPolygons(data = Augustb1,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustb1$NAMES, "<br>",
                               "Block: ", Augustb1$NAME, "<br>",
                               "Max Temperature: ", round(Augustb1$AugustF, 2)), group = "1990 August") %>% 
    addPolygons(data = Augustb2,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustb2$NAMES, "<br>",
                               "Block: ", Augustb2$NAME, "<br>",
                               "Max Temperature: ", round(Augustb2$AugustF, 2)), group = "2000 August") %>% 
    addPolygons(data = Augustb3,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustb3$NAMES, "<br>",
                               "Block: ", Augustb3$NAME, "<br>",
                               "Max Temperature: ", round(Augustb3$AugustF, 2)), group = "2010 August") %>% 
    addPolygons(data = Augustb4,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustb4$NAMES, "<br>",
                               "Block: ", Augustb4$NAME, "<br>",
                               "Max Temperature: ", round(Augustb4$AugustF, 2)), group = "2020 August") %>% 
    addLayersControl( baseGroups = c( "1980 August"
                                      , "1990 August"
                                      , "2000 August"
                                      , "2010 August"
                                      , "2020 August")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapb3 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                  , dragging = TRUE
                                                 
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Totpcpb,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpb$NAMES, "<br>",
                               "Block: ", Totpcpb$NAME, "<br>",
                               "Year Precipitation: ", round(Totpcpb$Totpcpinch, 2)), group = "1980 Precipitation") %>% 
    addPolygons(data = Totpcpb1,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpb1$NAMES, "<br>",
                               "Block: ", Totpcpb1$NAME, "<br>",
                               "Year Precipitation: ", round(Totpcpb1$Totpcpinch, 2)), group = "1990 Precipitation") %>% 
    addPolygons(data = Totpcpb2,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpb2$NAMES, "<br>",
                               "Block: ", Totpcpb2$NAME, "<br>",
                               "Year Precipitation: ", round(Totpcpb2$Totpcpinch, 2)), group = "2000 Precipitation") %>% 
    addPolygons(data = Totpcpb3,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpb3$NAMES, "<br>",
                               "Block: ", Totpcpb3$NAME, "<br>",
                               "Year Precipitation: ", round(Totpcpb3$Totpcpinch, 2)), group = "2010 Precipitation") %>% 
    addPolygons(data = Totpcpb4,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpb4$NAMES, "<br>",
                               "Block: ", Totpcpb4$NAME, "<br>",
                               "Year Precipitation: ", round(Totpcpb4$Totpcpinch, 2)), group = "2020 Precipitation") %>% 
    addLayersControl( baseGroups = c( "1980 Precipitation"
                                      , "1990 Precipitation"
                                      , "2000 Precipitation"
                                      , "2010 Precipitation"
                                      , "2020 Precipitation")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
```


```{r blocks groups, include=FALSE}
 June <- subset(eastern_daymet2, JuneF & Year == "1980")
  June1 <- subset(eastern_daymet2, JuneF & Year == "1990")
  June2 <- subset(eastern_daymet2, JuneF & Year == "2000")
  June3 <- subset(eastern_daymet2, JuneF & Year == "2010")
  June4  <- subset(eastern_daymet2, JuneF & Year == "2020")
  
  
  se.valuesbg <- list(June$JuneF
                      , June1$JuneF
                      , June2$JuneF
                      , June3$JuneF
                      , June4$JuneF
  )
  names( se.valuesbg ) <- c("June", "June", "June", "June", "June")
  
  
  se.color.valuesbg <- GroupValuesIntoColors( list.of.values = se.valuesbg[1]
                                              , desired.breaks = 5
                                              , min.color = "#EE82EE"
                                              , max.color = "#8B008B")
  
  
  
  se.color.valuesbgj1 <- GroupValuesIntoColors( list.of.values = se.valuesbg[2]
                                                , desired.breaks = 5
                                                , min.color = "#EE82EE"
                                                , max.color = "#8B008B"
  )
  
  se.color.valuesbgj2 <- GroupValuesIntoColors( list.of.values = se.valuesbg[3]
                                                , desired.breaks = 5
                                                , min.color = "#EE82EE"
                                                , max.color = "#8B008B"
  )
  
  se.color.valuesbgj3<- GroupValuesIntoColors( list.of.values = se.valuesbg[4]
                                               , desired.breaks = 5
                                               , min.color = "#EE82EE"
                                               , max.color = "#8B008B"
  )
  
  se.color.valuesbgj4<- GroupValuesIntoColors( list.of.values = se.valuesbg[5]
                                               , desired.breaks = 5
                                               , min.color = "#EE82EE"
                                               , max.color = "#8B008B"
  )
  
  June <- cbind.data.frame(June
                           , se.color.valuesbg
                           , stringsAsFactors = FALSE
  )
  
  June1 <- cbind.data.frame(June1
                            , se.color.valuesbgj1
                            , stringsAsFactors = FALSE
  )
  
  June2 <- cbind.data.frame(June2
                            , se.color.valuesbgj2
                            , stringsAsFactors = FALSE
  )
  
  June3 <- cbind.data.frame(June3
                            , se.color.valuesbgj3
                            , stringsAsFactors = FALSE
  )
  
  June4 <- cbind.data.frame(June4
                            , se.color.valuesbgj4
                            , stringsAsFactors = FALSE
  )
  
  
  June <- st_as_sf(June)
  June1 <- st_as_sf(June1)
  June2 <- st_as_sf(June2)
  June3 <- st_as_sf(June3)
  June4 <- st_as_sf(June4)
  
  ## July 
  
  July <- subset(eastern_daymet2, JulyF & Year == "1980")
  July1 <- subset(eastern_daymet2, JulyF & Year == "1990")
  July2 <- subset(eastern_daymet2, JulyF & Year == "2000")
  July3 <- subset(eastern_daymet2, JulyF & Year == "2010")
  July4  <- subset(eastern_daymet2, JulyF & Year == "2020")
  
  
  se.valuesbg1 <- list(July$JulyF
                       , July1$JulyF
                       , July2$JulyF
                       , July3$JulyF
                       , July4$JulyF
  )
  
  names( se.valuesbg1 ) <- c("July", "July", "July", "July", "July")
  
  
  
  se.color.valuesbgjl <- GroupValuesIntoColors( list.of.values = se.valuesbg1[1]
                                                , desired.breaks = 5
                                                , min.color = "#FFFF00"
                                                , max.color = "#FF4500"
  )
  
  
  se.color.valuesbgjl1 <- GroupValuesIntoColors( list.of.values = se.valuesbg1[2]
                                                 , desired.breaks = 5
                                                 , min.color = "#FFFF00"
                                                 , max.color = "#FF4500"
  )
  
  se.color.valuesbgjl2 <- GroupValuesIntoColors( list.of.values = se.valuesbg1[3]
                                                 , desired.breaks = 5
                                                 , min.color = "#FFFF00"
                                                 , max.color = "#FF4500"
  )
  
  se.color.valuesbgjl3<- GroupValuesIntoColors( list.of.values = se.valuesbg1[4]
                                                , desired.breaks = 5
                                                , min.color = "#FFFF00"
                                                , max.color = "#FF4500"
  )
  
  se.color.valuesbgjl4<- GroupValuesIntoColors( list.of.values = se.valuesbg1[5]
                                                , desired.breaks = 5
                                                , min.color = "#FFFF00"
                                                , max.color = "#FF4500"
  )
  
  
  July <- cbind.data.frame(July
                           , se.color.valuesbgjl
                           , stringsAsFactors = FALSE
  )
  
  July1 <- cbind.data.frame(July1
                            , se.color.valuesbgjl1
                            , stringsAsFactors = FALSE
  )
  
  July2 <- cbind.data.frame(July2
                            , se.color.valuesbgjl2
                            , stringsAsFactors = FALSE
  )
  
  July3 <- cbind.data.frame(July3
                            , se.color.valuesbgjl3
                            , stringsAsFactors = FALSE
  )
  
  July4 <- cbind.data.frame(July4
                            , se.color.valuesbgjl4
                            , stringsAsFactors = FALSE
  )
  
  July <- st_as_sf(July)
  July1 <- st_as_sf(July1)
  July2 <- st_as_sf(July2)
  July3 <- st_as_sf(July3)
  July4 <- st_as_sf(July4)
  
  
  
  ##August
  
  August <- subset(eastern_daymet2, AugustF & Year == "1980")
  August1 <- subset(eastern_daymet2, AugustF & Year == "1990")
  August2 <- subset(eastern_daymet2, AugustF & Year == "2000")
  August3 <- subset(eastern_daymet2, AugustF & Year == "2010")
  August4  <- subset(eastern_daymet2, AugustF & Year == "2020")
  
  se.valuesbg2 <- list(August$AugustF
                       , August1$AugustF
                       , August2$AugustF
                       , August3$AugustF
                       , August4$AugustF
  )
  names( se.valuesbg2 ) <- c("August", "August", "August", "August", "August")
  
  
  
  
  se.color.valuesbga <- GroupValuesIntoColors( list.of.values = se.valuesbg2[1]
                                               , desired.breaks = 5
                                               , min.color = "#ADFF2F"
                                               , max.color = "#006400"
  )
  
  
  se.color.valuesbga1 <- GroupValuesIntoColors( list.of.values = se.valuesbg2[2]
                                                , desired.breaks = 5
                                                , min.color = "#ADFF2F"
                                                , max.color = "#006400"
  )
  
  se.color.valuesbga2 <- GroupValuesIntoColors( list.of.values = se.valuesbg2[3]
                                                , desired.breaks = 5
                                                , min.color = "#ADFF2F"
                                                , max.color = "#006400"
  )
  
  se.color.valuesbga3<- GroupValuesIntoColors( list.of.values = se.valuesbg2[4]
                                               , desired.breaks = 5
                                               , min.color = "#ADFF2F"
                                               , max.color = "#006400"
  )
  
  se.color.valuesbga4<- GroupValuesIntoColors( list.of.values = se.valuesbg2[5]
                                               , desired.breaks = 5
                                               , min.color = "#ADFF2F"
                                               , max.color = "#006400"
  )
  
  August <- cbind.data.frame(August
                             , se.color.valuesbga
                             , stringsAsFactors = FALSE
  )
  
  August1 <- cbind.data.frame(August1
                              , se.color.valuesbga1
                              , stringsAsFactors = FALSE
  )
  
  August2 <- cbind.data.frame(August2
                              , se.color.valuesbga2
                              , stringsAsFactors = FALSE
  )
  
  August3 <- cbind.data.frame(August3
                              , se.color.valuesbga3
                              , stringsAsFactors = FALSE
  )
  
  August4 <- cbind.data.frame(August4
                              , se.color.valuesbga4
                              , stringsAsFactors = FALSE
  )
  
  
  August <- st_as_sf(August)
  August1 <- st_as_sf(August1)
  August2 <- st_as_sf(August2)
  August3 <- st_as_sf(August3)
  August4 <- st_as_sf(August4)
  
  
  ##Precipitation
  
  Totpcp <- subset(eastern_daymet2, Totpcpinch & Year == "1980")
  Totpcp1 <- subset(eastern_daymet2, Totpcpinch & Year == "1990")
  Totpcp2 <- subset(eastern_daymet2, Totpcpinch & Year == "2000")
  Totpcp3 <- subset(eastern_daymet2, Totpcpinch & Year == "2010")
  Totpcp4  <- subset(eastern_daymet2, Totpcpinch & Year == "2020")
  
  
  se.valuesbg3 <- list(Totpcp$Totpcpinch
                       , Totpcp1$Totpcpinch
                       , Totpcp2$Totpcpinch
                       , Totpcp3$Totpcpinch
                       , Totpcp4$Totpcpinch
  )
  names( se.valuesbg3 ) <- c("Total Precipitation", "Total Precipitation", "Total Precipitation", "Total Precipitation", "Total Precipitation")
  
  
  
  se.color.valuesbgt <- GroupValuesIntoColors( list.of.values = se.valuesbg3[1]
                                               , desired.breaks = 5
                                               , min.color = "#ADD8E6"
                                               , max.color = "#00008B"
  )
  
  
  se.color.valuesbgt1 <- GroupValuesIntoColors( list.of.values = se.valuesbg3[2]
                                                , desired.breaks = 5
                                                , min.color = "#ADD8E6"
                                                , max.color = "#00008B"
  )
  
  se.color.valuesbgt2 <- GroupValuesIntoColors( list.of.values = se.valuesbg3[3]
                                                , desired.breaks = 5
                                                , min.color = "#ADD8E6"
                                                , max.color = "#00008B"
  )
  
  se.color.valuesbgt3<- GroupValuesIntoColors( list.of.values = se.valuesbg3[4]
                                               , desired.breaks = 5
                                               , min.color = "#ADD8E6"
                                               , max.color = "#00008B"
  )
  
  se.color.valuesbgt4<- GroupValuesIntoColors( list.of.values = se.valuesbg3[5]
                                               , desired.breaks = 5
                                               , min.color = "#ADD8E6"
                                               , max.color = "#00008B"
  )
  
  Totpcp <- cbind.data.frame(Totpcp
                             , se.color.valuesbgt
                             , stringsAsFactors = FALSE
  )
  
  Totpcp1 <- cbind.data.frame(Totpcp1
                              , se.color.valuesbgt1
                              , stringsAsFactors = FALSE
  )
  
  Totpcp2 <- cbind.data.frame(Totpcp2
                              , se.color.valuesbgt2
                              , stringsAsFactors = FALSE
  )
  
  Totpcp3 <- cbind.data.frame(Totpcp3
                              , se.color.valuesbgt3
                              , stringsAsFactors = FALSE
  )
  
  Totpcp4 <- cbind.data.frame(Totpcp4
                              , se.color.valuesbgt4
                              , stringsAsFactors = FALSE
  )
  
  
  Totpcp <- st_as_sf(Totpcp)
  Totpcp1 <- st_as_sf(Totpcp1)
  Totpcp2 <- st_as_sf(Totpcp2)
  Totpcp3 <- st_as_sf(Totpcp3)
  Totpcp4 <- st_as_sf(Totpcp4)
  
  
  mapTitle <- paste0(
    "<p style='color:#ED7B46; font-size:14px;'>"
    , "Eastern DAYMET Temperature Data by Block Group, 1980, 1990, 2000, 2010, 2020"
    , "</p>"
  )
  
  
  blockmapbg <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                  , dragging = TRUE 
                                                 
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = June,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", June$NAMES, "<br>",
                               "Block Group: ", June$NAMELSAD, "<br>",
                               "Max Temperature: ", round(June$JuneF, 2)), group = "1980 June") %>% 
    addPolygons(data = June1,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", June1$NAMES, "<br>",
                               "Block Group: ", June1$NAMELSAD, "<br>",
                               "Max Temperature: ", round(June1$JuneF, 2)), group = "1990 June") %>% 
    addPolygons(data = June2,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", June2$NAMES, "<br>",
                               "Block Group: ", June2$NAMELSAD, "<br>",
                               "Max Temperature: ", round(June2$JuneF, 2)), group = "2000 June") %>% 
    addPolygons(data = June3,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", June3$NAMES, "<br>",
                               "Block Group: ", June3$NAMELSAD, "<br>",
                               "Max Temperature: ", round(June3$JuneF, 2)), group = "2010 June") %>% 
    addPolygons(data = June4,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", June4$NAMES, "<br>",
                               "Block Group: ", June4$NAMELSAD, "<br>",
                               "Max Temperature: ", round(June4$JuneF, 2)), group = "2020 June") %>% 
    addLayersControl( baseGroups = c( "1980 June"
                                      , "1990 June"
                                      , "2000 June"
                                      , "2010 June"
                                      , "2020 June")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapbg1 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                   , dragging = TRUE 
                                                  
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = July,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", July$NAMES, "<br>",
                               "Block Group: ", July$NAMELSAD, "<br>",
                               "Max Temperature: ", round(July$JulyF, 2)), group = "1980 July") %>% 
    addPolygons(data = July1,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", July1$NAMES, "<br>",
                               "Block Group: ", July1$NAMELSAD, "<br>",
                               "Max Temperature: ", round(July1$JulyF, 2)), group = "1990 July") %>% 
    addPolygons(data = July2,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", July2$NAMES, "<br>",
                               "Block Group: ", July2$NAMELSAD, "<br>",
                               "Max Temperature: ", round(July2$JulyF, 2)), group = "2000 July") %>% 
    addPolygons(data = July3,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", July3$NAMES, "<br>",
                               "Block Group: ", July3$NAMELSAD, "<br>",
                               "Max Temperature: ", round(July3$JulyF, 2)), group = "2010 July") %>% 
    addPolygons(data = July4,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", July4$NAMES, "<br>",
                               "Block Group: ", July4$NAMELSAD, "<br>",
                               "Max Temperature: ", round(July4$JulyF, 2)), group = "2020 July") %>% 
    addLayersControl( baseGroups = c( "1980 July"
                                      , "1990 July"
                                      , "2000 July"
                                      , "2010 July"
                                      , "2020 July")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapbg2 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                   , dragging = TRUE 
                                                  
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = August,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", August$NAMES, "<br>",
                               "Block Group: ", August$NAMELSAD, "<br>",
                               "Max Temperature: ", round(August$AugustF, 2)), group = "1980 August") %>% 
    addPolygons(data = August1,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", August1$NAMES, "<br>",
                               "Block Group: ", August1$NAMELSAD, "<br>",
                               "Max Temperature: ", round(August1$AugustF, 2)), group = "1990 August") %>% 
    addPolygons(data = August2,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", August2$NAMES, "<br>",
                               "Block Group: ", August2$NAMELSAD, "<br>",
                               "Max Temperature: ", round(August2$AugustF, 2)), group = "2000 August") %>% 
    addPolygons(data = August3,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", August3$NAMES, "<br>",
                               "Block Group: ", August3$NAMELSAD, "<br>",
                               "Max Temperature: ", round(August3$AugustF, 2)), group = "2010 August") %>% 
    addPolygons(data = August4,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", August4$NAMES, "<br>",
                               "Block Group: ", August4$NAMELSAD, "<br>",
                               "Max Temperature: ", round(August4$AugustF, 2)), group = "2020 August") %>% 
    addLayersControl( baseGroups = c( "1980 August"
                                      , "1990 August"
                                      , "2000 August"
                                      , "2010 August"
                                      , "2020 August")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapbg3 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                   , dragging = TRUE 
                                                  
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Totpcp,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcp$NAMES, "<br>",
                               "Block Group: ", Totpcp$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcp$Totpcpinch, 2)), group = "1980 Precipitation") %>% 
    addPolygons(data = Totpcp1,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcp1$NAMES, "<br>",
                               "Block Group: ", Totpcp1$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcp1$Totpcpinch, 2)), group = "1990 Precipitation") %>% 
    addPolygons(data = Totpcp2,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcp2$NAMES, "<br>",
                               "Block Group: ", Totpcp2$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcp2$Totpcpinch, 2)), group = "2000 Precipitation") %>% 
    addPolygons(data = Totpcp3,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcp3$NAMES, "<br>",
                               "Block Group: ", Totpcp3$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcp3$Totpcpinch, 2)), group = "2010 Precipitation") %>% 
    addPolygons(data = Totpcp4,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcp4$NAMES, "<br>",
                               "Block Group: ", Totpcp4$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcp4$Totpcpinch, 2)), group = "2020 Precipitation") %>% 
    addLayersControl( baseGroups = c( "1980 Precipitation"
                                      , "1990 Precipitation"
                                      , "2000 Precipitation"
                                      , "2010 Precipitation"
                                      , "2020 Precipitation")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
```

```{r tracts, include=FALSE}

  Junet <- subset(eastern_daymet3, JuneF & Year == "1980")
  Junet1 <- subset(eastern_daymet3, JuneF & Year == "1990")
  Junet2 <- subset(eastern_daymet3, JuneF & Year == "2000")
  Junet3 <- subset(eastern_daymet3, JuneF & Year == "2010")
  Junet4  <- subset(eastern_daymet3, JuneF & Year == "2020")
  
  
  se.valuest <- list(Junet$JuneF
                     , Junet1$JuneF
                     , Junet2$JuneF
                     , Junet3$JuneF
                     , Junet4$JuneF
  )
  names( se.valuest) <- c("June", "June", "June", "June", "June")
  
  
  se.color.valuest <- GroupValuesIntoColors( list.of.values = se.valuest[1]
                                             , desired.breaks = 5
                                             , min.color = "#EE82EE"
                                             , max.color = "#8B008B")
  
  
  
  se.color.valuestj1 <- GroupValuesIntoColors( list.of.values = se.valuest[2]
                                               , desired.breaks = 5
                                               , min.color = "#EE82EE"
                                               , max.color = "#8B008B"
  )
  
  se.color.valuestj2 <- GroupValuesIntoColors( list.of.values = se.valuest[3]
                                               , desired.breaks = 5
                                               , min.color = "#EE82EE"
                                               , max.color = "#8B008B"
  )
  
  se.color.valuestj3<- GroupValuesIntoColors( list.of.values = se.valuest[4]
                                              , desired.breaks = 5
                                              , min.color = "#EE82EE"
                                              , max.color = "#8B008B"
  )
  
  se.color.valuestj4<- GroupValuesIntoColors( list.of.values = se.valuest[5]
                                              , desired.breaks = 5
                                              , min.color = "#EE82EE"
                                              , max.color = "#8B008B"
  )
  
  Junet <- cbind.data.frame(Junet
                            , se.color.valuest
                            , stringsAsFactors = FALSE
  )
  
  Junet1 <- cbind.data.frame(Junet1
                             , se.color.valuestj1
                             , stringsAsFactors = FALSE
  )
  
  Junet2 <- cbind.data.frame(Junet2
                             , se.color.valuestj2
                             , stringsAsFactors = FALSE
  )
  
  Junet3 <- cbind.data.frame(Junet3
                             , se.color.valuestj3
                             , stringsAsFactors = FALSE
  )
  
  Junet4 <- cbind.data.frame(Junet4
                             , se.color.valuestj4
                             , stringsAsFactors = FALSE
  )
  
  
  Junet <- st_as_sf(Junet)
  Junet1 <- st_as_sf(Junet1)
  Junet2 <- st_as_sf(Junet2)
  Junet3 <- st_as_sf(Junet3)
  Junet4 <- st_as_sf(Junet4)
  
  ## July 
  
  Julyt <- subset(eastern_daymet3, JulyF & Year == "1980")
  Julyt1 <- subset(eastern_daymet3, JulyF & Year == "1990")
  Julyt2 <- subset(eastern_daymet3, JulyF & Year == "2000")
  Julyt3 <- subset(eastern_daymet3, JulyF & Year == "2010")
  Julyt4  <- subset(eastern_daymet3, JulyF & Year == "2020")
  
  
  se.valuest1 <- list(Julyt$JulyF
                      , Julyt1$JulyF
                      , Julyt2$JulyF
                      , Julyt3$JulyF
                      , Julyt4$JulyF
  )
  
  names( se.valuest1 ) <- c("July", "July", "July", "July", "July")
  
  
  
  se.color.valuestjl <- GroupValuesIntoColors( list.of.values = se.valuest1[1]
                                               , desired.breaks = 5
                                               , min.color = "#FFFF00"
                                               , max.color = "#FF4500"
  )
  
  
  se.color.valuestjl1 <- GroupValuesIntoColors( list.of.values = se.valuest1[2]
                                                , desired.breaks = 5
                                                , min.color = "#FFFF00"
                                                , max.color = "#FF4500"
  )
  
  se.color.valuestjl2 <- GroupValuesIntoColors( list.of.values = se.valuest1[3]
                                                , desired.breaks = 5
                                                , min.color = "#FFFF00"
                                                , max.color = "#FF4500"
  )
  
  se.color.valuestjl3<- GroupValuesIntoColors( list.of.values = se.valuest1[4]
                                               , desired.breaks = 5
                                               , min.color = "#FFFF00"
                                               , max.color = "#FF4500"
  )
  
  se.color.valuestjl4<- GroupValuesIntoColors( list.of.values = se.valuest1[5]
                                               , desired.breaks = 5
                                               , min.color = "#FFFF00"
                                               , max.color = "#FF4500"
  )
  
  
  Julyt <- cbind.data.frame(Julyt
                            , se.color.valuestjl
                            , stringsAsFactors = FALSE
  )
  
  Julyt1 <- cbind.data.frame(Julyt1
                             , se.color.valuestjl1
                             , stringsAsFactors = FALSE
  )
  
  Julyt2 <- cbind.data.frame(Julyt2
                             , se.color.valuestjl2
                             , stringsAsFactors = FALSE
  )
  
  Julyt3 <- cbind.data.frame(Julyt3
                             , se.color.valuestjl3
                             , stringsAsFactors = FALSE
  )
  
  Julyt4 <- cbind.data.frame(Julyt4
                             , se.color.valuestjl4
                             , stringsAsFactors = FALSE
  )
  
  Julyt <- st_as_sf(Julyt)
  Julyt1 <- st_as_sf(Julyt1)
  Julyt2 <- st_as_sf(Julyt2)
  Julyt3 <- st_as_sf(Julyt3)
  Julyt4 <- st_as_sf(Julyt4)
  
  
  
  ##August
  
  Augustt <- subset(eastern_daymet3, AugustF & Year == "1980")
  Augustt1 <- subset(eastern_daymet3, AugustF & Year == "1990")
  Augustt2 <- subset(eastern_daymet3, AugustF & Year == "2000")
  Augustt3 <- subset(eastern_daymet3, AugustF & Year == "2010")
  Augustt4  <- subset(eastern_daymet3, AugustF & Year == "2020")
  
  se.valuest2 <- list(Augustt$AugustF
                      , Augustt1$AugustF
                      , Augustt2$AugustF
                      , Augustt3$AugustF
                      , Augustt4$AugustF
  )
  names( se.valuest2 ) <- c("August", "August", "August", "August", "August")
  
  
  
  
  se.color.valuesta <- GroupValuesIntoColors( list.of.values = se.valuest2[1]
                                              , desired.breaks = 5
                                              , min.color = "#ADFF2F"
                                              , max.color = "#006400"
  )
  
  
  se.color.valuesta1 <- GroupValuesIntoColors( list.of.values = se.valuest2[2]
                                               , desired.breaks = 5
                                               , min.color = "#ADFF2F"
                                               , max.color = "#006400"
  )
  
  se.color.valuesta2 <- GroupValuesIntoColors( list.of.values = se.valuest2[3]
                                               , desired.breaks = 5
                                               , min.color = "#ADFF2F"
                                               , max.color = "#006400"
  )
  
  se.color.valuesta3<- GroupValuesIntoColors( list.of.values = se.valuest2[4]
                                              , desired.breaks = 5
                                              , min.color = "#ADFF2F"
                                              , max.color = "#006400"
  )
  
  se.color.valuesta4<- GroupValuesIntoColors( list.of.values = se.valuest2[5]
                                              , desired.breaks = 5
                                              , min.color = "#ADFF2F"
                                              , max.color = "#006400"
  )
  
  Augustt <- cbind.data.frame(Augustt
                              , se.color.valuesta
                              , stringsAsFactors = FALSE
  )
  
  Augustt1 <- cbind.data.frame(Augustt1
                               , se.color.valuesta1
                               , stringsAsFactors = FALSE
  )
  
  Augustt2 <- cbind.data.frame(Augustt2
                               , se.color.valuesta2
                               , stringsAsFactors = FALSE
  )
  
  Augustt3 <- cbind.data.frame(Augustt3
                               , se.color.valuesta3
                               , stringsAsFactors = FALSE
  )
  
  Augustt4 <- cbind.data.frame(Augustt4
                               , se.color.valuesta4
                               , stringsAsFactors = FALSE
  )
  
  
  Augustt <- st_as_sf(Augustt)
  Augustt1 <- st_as_sf(Augustt1)
  Augustt2 <- st_as_sf(Augustt2)
  Augustt3 <- st_as_sf(Augustt3)
  Augustt4 <- st_as_sf(Augustt4)
  
  
  ##Precipitation
  
  Totpcpt <- subset(eastern_daymet3, Totpcpinch & Year == "1980")
  Totpcpt1 <- subset(eastern_daymet3, Totpcpinch & Year == "1990")
  Totpcpt2 <- subset(eastern_daymet3, Totpcpinch & Year == "2000")
  Totpcpt3 <- subset(eastern_daymet3, Totpcpinch & Year == "2010")
  Totpcpt4  <- subset(eastern_daymet3, Totpcpinch & Year == "2020")
  
  
  se.valuest3 <- list(Totpcpt$Totpcpinch
                      , Totpcpt1$Totpcpinch
                      , Totpcpt2$Totpcpinch
                      , Totpcpt3$Totpcpinch
                      , Totpcpt4$Totpcpinch
  )
  names( se.valuest3 ) <- c("Total Precipitation", "Total Precipitation", "Total Precipitation", "Total Precipitation", "Total Precipitation")
  
  
  
  se.color.valuestt <- GroupValuesIntoColors( list.of.values = se.valuest3[1]
                                              , desired.breaks = 5
                                              , min.color = "#ADD8E6"
                                              , max.color = "#00008B"
  )
  
  
  se.color.valuestt1 <- GroupValuesIntoColors( list.of.values = se.valuest3[2]
                                               , desired.breaks = 5
                                               , min.color = "#ADD8E6"
                                               , max.color = "#00008B"
  )
  
  se.color.valuestt2 <- GroupValuesIntoColors( list.of.values = se.valuest3[3]
                                               , desired.breaks = 5
                                               , min.color = "#ADD8E6"
                                               , max.color = "#00008B"
  )
  
  se.color.valuestt3<- GroupValuesIntoColors( list.of.values = se.valuest3[4]
                                              , desired.breaks = 5
                                              , min.color = "#ADD8E6"
                                              , max.color = "#00008B"
  )
  
  se.color.valuestt4<- GroupValuesIntoColors( list.of.values = se.valuest3[5]
                                              , desired.breaks = 5
                                              , min.color = "#ADD8E6"
                                              , max.color = "#00008B"
  )
  
  Totpcpt <- cbind.data.frame(Totpcpt
                              , se.color.valuestt
                              , stringsAsFactors = FALSE
  )
  
  Totpcpt1 <- cbind.data.frame(Totpcpt1
                               , se.color.valuestt1
                               , stringsAsFactors = FALSE
  )
  
  Totpcpt2 <- cbind.data.frame(Totpcpt2
                               , se.color.valuestt2
                               , stringsAsFactors = FALSE
  )
  
  Totpcpt3 <- cbind.data.frame(Totpcpt3
                               , se.color.valuestt3
                               , stringsAsFactors = FALSE
  )
  
  Totpcpt4 <- cbind.data.frame(Totpcpt4
                               , se.color.valuestt4
                               , stringsAsFactors = FALSE
  )
  
  
  Totpcpt <- st_as_sf(Totpcpt)
  Totpcpt1 <- st_as_sf(Totpcpt1)
  Totpcpt2 <- st_as_sf(Totpcpt2)
  Totpcpt3 <- st_as_sf(Totpcpt3)
  Totpcpt4 <- st_as_sf(Totpcpt4)
  
  mapTitle <- paste0(
    "<p style='color:#ED7B46; font-size:14px;'>"
    , "Eastern DAYMET Temperature Data by Tracts, 1980, 1990, 2000, 2010, 2020"
    , "</p>"
  )
  
  
  blockmapt <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                 , dragging = TRUE 
                                                
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Junet,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Junet$NAMES, "<br>",
                               "Tract: ", Junet$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Junet$JuneF, 2)), group = "1980 June") %>% 
    addPolygons(data = Junet1,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Junet1$NAMES, "<br>",
                               "Tract: ", Junet1$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Junet1$JuneF, 2)), group = "1990 June") %>% 
    addPolygons(data = Junet2,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Junet2$NAMES, "<br>",
                               "Tract: ", Junet2$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Junet2$JuneF, 2)), group = "2000 June") %>% 
    addPolygons(data = Junet3,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Junet3$NAMES, "<br>",
                               "Tract: ", Junet3$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Junet3$JuneF, 2)), group = "2010 June") %>% 
    addPolygons(data = Junet4,
                fillColor = ~color_June,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Junet4$NAMES, "<br>",
                               "Tract: ", Junet4$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Junet4$JuneF, 2)), group = "2020 June") %>% 
    addLayersControl( baseGroups = c( "1980 June"
                                      , "1990 June"
                                      , "2000 June"
                                      , "2010 June"
                                      , "2020 June")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapt1 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                  , dragging = TRUE 
                                                 
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Julyt,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyt$NAMES, "<br>",
                               "Tract: ", Julyt$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Julyt$JulyF, 2)), group = "1980 July") %>% 
    addPolygons(data = Julyt1,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyt1$NAMES, "<br>",
                               "Tract: ", Julyt1$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Julyt1$JulyF, 2)), group = "1990 July") %>% 
    addPolygons(data = Julyt2,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyt2$NAMES, "<br>",
                               "Tract: ", Julyt2$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Julyt2$JulyF, 2)), group = "2000 July") %>% 
    addPolygons(data = Julyt3,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyt3$NAMES, "<br>",
                               "Tract: ", Julyt3$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Julyt3$JulyF, 2)), group = "2010 July") %>% 
    addPolygons(data = Julyt4,
                fillColor = ~color_July,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Julyt4$NAMES, "<br>",
                               "Tract: ", Julyt4$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Julyt4$JulyF, 2)), group = "2020 July") %>% 
    addLayersControl( baseGroups = c( "1980 July"
                                      , "1990 July"
                                      , "2000 July"
                                      , "2010 July"
                                      , "2020 July")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapt2 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                  , dragging = TRUE 
                                                 
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Augustt,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustt$NAMES, "<br>",
                               "Tract: ", Augustt$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Augustt$AugustF, 2)), group = "1980 August") %>% 
    addPolygons(data = Augustt1,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustt1$NAMES, "<br>",
                               "Tract: ", Augustt1$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Augustt1$AugustF, 2)), group = "1990 August") %>% 
    addPolygons(data = Augustt2,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustt2$NAMES, "<br>",
                               "Tract: ", Augustt2$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Augustt2$AugustF, 2)), group = "2000 August") %>% 
    addPolygons(data = Augustt3,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustt3$NAMES, "<br>",
                               "Tract: ", Augustt3$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Augustt3$AugustF, 2)), group = "2010 August") %>% 
    addPolygons(data = Augustt4,
                fillColor = ~color_August,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Augustt4$NAMES, "<br>",
                               "Tract: ", Augustt4$NAMELSAD, "<br>",
                               "Max Temperature: ", round(Augustt4$AugustF, 2)), group = "2020 August") %>% 
    addLayersControl( baseGroups = c( "1980 August"
                                      , "1990 August"
                                      , "2000 August"
                                      , "2010 August"
                                      , "2020 August")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
  blockmapt3 <- leaflet(options = leafletOptions( zoomControl = FALSE
                                                  , dragging = TRUE
                                                 
  ) ) %>%
    
    # set zoom level
    # so that all 77 community areas can be seen when the
    # map is opened
    # Note: the lng/lat pair is northeast of Promontory Point
    # between West Pershing Rd and W 47th st
    setView( lng = -75.8069
             , lat = 37.2268
             , zoom = 8) %>% 
    addProviderTiles("CartoDB.Positron") %>%
    addPolygons(data = Totpcpt,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpt$NAMES, "<br>",
                               "Tract: ", Totpcpt$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcpt$Totpcpinch, 2)), group = "1980 Precipitation") %>% 
    addPolygons(data = Totpcpt1,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpt1$NAMES, "<br>",
                               "Tract: ", Totpcpt1$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcpt1$Totpcpinch, 2)), group = "1990 Precipitation") %>% 
    addPolygons(data = Totpcpt2,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpt2$NAMES, "<br>",
                               "Tract: ", Totpcpt2$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcpt2$Totpcpinch, 2)), group = "2000 Precipitation") %>% 
    addPolygons(data = Totpcpt3,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpt3$NAMES, "<br>",
                               "Tract: ", Totpcpt3$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcpt3$Totpcpinch, 2)), group = "2010 Precipitation") %>% 
    addPolygons(data = Totpcpt4,
                fillColor = ~`color_Total Precipitation`,
                weight = 1,
                opacity = 1,
                color = "white", 
                fillOpacity = 0.6,
                highlight = highlightOptions(
                  weight = 2,
                  fillOpacity = 0.8,
                  bringToFront = T
                ),
                popup = paste0("County: ", Totpcpt4$NAMES, "<br>",
                               "Tract: ", Totpcpt4$NAMELSAD, "<br>",
                               "Year Precipitation: ", round(Totpcpt4$Totpcpinch, 2)), group = "2020 Precipitation") %>% 
    addLayersControl( baseGroups = c( "1980 Precipitation"
                                      , "1990 Precipitation"
                                      , "2000 Precipitation"
                                      , "2010 Precipitation"
                                      , "2020 Precipitation")
                      , options = layersControlOptions( collapsed = FALSE )
                      , position = "topright" )
  
  
```

# Data Source

Source: Daymet: Monthly Climate Summaries on a 1-km Grid for North America, Version 4, December 2020 release. The first link is a direct download link from the Daymet website, however, you have to register and sign in to download the file. The second link is to the fedData documentation which allows you to directly download the dayment data without signing in.


* DAYMET Direct Data Download URL: [https://daac.ornl.gov/cgi-bin/dsviewer.pl?ds_id=1855](https://daac.ornl.gov/cgi-bin/dsviewer.pl?ds_id=1855)

* FedData Documentation URL: [https://ropensci.org/blog/2017/08/24/feddata-release/](hhttps://ropensci.org/blog/2017/08/24/feddata-release/)


## The Data Used Here

Daymet is a data product derived from a collection of algorithms and computer software designed to interpolate and extrapolate from daily meteorological observations to produce gridded estimates of daily weather parameters. Weather parameters generated include daily surfaces of minimum and maximum temperature, precipitation, vapor pressure, radiation, snow water equivalent, and day length produced on a 1 km x 1 km gridded surface. 

The motivation for producing Daymet is to provide measurements of near-surface meteorological conditions where no instrumentation exists. Having estimates of these surfaces is critical to understanding many processes in the terrestrial biogeochemical system.

Daymet model predicted data for the three model parameters: tmin, tmax, and prcp. Also included are corresponding station metadata files for each variable and year, including the station name, station identification, latitude, and longitude. The data covers years from 1980-2020. 

The data here is the monthly data at the block, block groups, and tract level for Accomack and Northampton counties in the Eastern Shore Region of Virginia . While DAYMET includes information on a variety of climate measures, we are focusing on the maximum temperature and precipitation of the counties of interest. The maximum temperature was originally recorded in Celsuis and the precipitation in Millimeters, they were both converted to Fahrenheit and Inches respectively to make it easier for our audience.  

To Learn More, See: 

* [Daily Surface Weather and Climatological Summaries ](https://daymet.ornl.gov/overview)

# Analysis {.tabset} 

The data has the federal information processing system (FIPS) codes which are used to identify a geographical location, both the state and county FIPS code are in the data. The census tract number, the census block number, thr geographical ID number of the block, the block name, the year we are observing, and temperature data. The data has years of observation 1980, 1990, 2000, 2010, and 2020, the temperature data for each county for the months of June, July, and August, for all years, and the total annual precipitation for the counties, for all years. 

Temperature observations are county level estimates of...

* Monthly maximum temperature for each county for years 1980, 1990, 2000, 2010, and 2020. 
    * Average maximum temperature for the months of June, July, and August, for each county for those years. The data includes the temperature in Celsius and Fahrenheit. However, the visualization is using only data in Fahrenheit.
    
* Yearly precipitation for each county for years 1980, 1990, 2000, 2010, and 2020. 
    * Total yearly precipitation for each county for those years. The data includes the precipitation in Millimeter and Inches. However, the visualization is using only data in Inches.
    

## Blocks {.tabset}

### Variable Description 

A Brief View of the Block Level Data for the Eastern Shore Region

```{r}
daymet1a <- filter(daymet1, GEOID %in% c("510010901001000", "511319302003081"))
kbl(daymet1a) %>%
  kable_paper(full_width = F)  %>% 
   scroll_box(width = "800px", height = "300px")
```


### Summaries 

Summary of the Eastern Shore Region Block Level Data

```{r}
daymet1 %>%  dplyr::select(-c(STATEFP:NAME, June:August, Totpcp)) %>% 
   dplyr::select(where(~is.numeric(.x) && !is.na(.x))) %>% 
  as.data.frame() %>% 
  stargazer(., type = "text", title = "Summary Statistics", digits = 0,
            summary.stat = c("mean", "sd", "min", "median", "max"))
```


## Block Maps

Variation Across Blocks

The goal of the project is to identify the effects of climate change on the hot weather patterns in the counties. We chose June, July, August as the months of interest because they represent summer months. We believe they are the hottest months of the year and allows us to observe temperature fluctuations in stable month periods. We also chose 1980, 1990, 2000, 2010, and 2020 as years to explore because of the density of the available data and for clearer understanding of variation over time.
  
This is an interactive graph. Click on the graph to zoom and click on the counties to see information on the temperature for that location. Click through each year to see the changes in the block level temperature readings for all counties for each year. 


```{r, echo=FALSE}
shinyApp(ui = shiny::fluidPage(
  titlePanel(title = h4("Eastern Shore DAYMET Temperature Data by Block: Years: 1980, 1990, 2000, 2010, 2020")),
  mainPanel(
    
    # Output: Tabset w/ plot, summary, and table ----
    tabsetPanel(type = "tabs",
                tabPanel("June Max Temperature", leaflet::leafletOutput( outputId = "map", height = 500, width = "800px")),
                tabPanel("July Max Temperature", leaflet::leafletOutput( outputId = "map1", height = 500, width = "800px")),
                tabPanel("August Max Temperature", leaflet::leafletOutput( outputId = "map2", height = 500, width = "800px")),
                tabPanel("Total Precipitation", leaflet::leafletOutput( outputId = "map3", height = 500, width = "800px")))
  )), 
  
  server =  function(input, output){
  
  
  # render the map
  output$map <- leaflet::renderLeaflet({
    blockmapb
  })
  
  output$map1 <- leaflet::renderLeaflet({
    blockmapb1
  })
  output$map2 <- leaflet::renderLeaflet({
    blockmapb2
  })
  
  output$map3 <- leaflet::renderLeaflet({
    blockmapb3
  })
  
  #### If statement for Dynamic Leaflet Legend ####
  observeEvent( input$map_groups,{
    
    map <- leafletProxy("map") %>% clearControls()
    
    if( input$map_groups == "1980 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 June"
                            , colors = unique(Juneb$color_June)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "1990 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 June"
                            , colors = unique(Juneb1$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2000 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 June"
                            , colors = unique(Juneb2$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2010 June" ){
      
      map <- map %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 June"
                            , colors = unique(Juneb3$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2020 June" ){
      
      map <- map %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 June"
                            , colors = unique(Juneb4$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  
    # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map1_groups,{
    
    map1 <- leafletProxy("map1") %>% clearControls()
    
    if( input$map1_groups == "1980 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 July"
                            , colors = unique(Julyb$color_July)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "1990 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 July"
                            , colors = unique(Julyb1$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2000 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 July"
                            , colors = unique(Julyb2$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2010 July" ){
      
      map1 <- map1 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 July"
                            , colors = unique(Julyb3$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2020 July" ){
      
      map1 <- map1 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 July"
                            , colors = unique(Julyb4$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map2_groups,{
    
    map2 <- leafletProxy("map2") %>% clearControls()
    
    if( input$map2_groups == "1980 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 August"
                            , colors = unique(Augustb$color_August)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "1990 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 August"
                            , colors = unique(Augustb1$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2000 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 August"
                            , colors = unique(Augustb2$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2010 August" ){
      
      map2 <- map2 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 August"
                            , colors = unique(Augustb3$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2020 August" ){
      
      map2 <- map2 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 August"
                            , colors = unique(Augustb4$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map3_groups,{
    
    map3 <- leafletProxy("map3") %>% clearControls()
    
    if( input$map3_groups == "1980 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 Precipitation"
                            , colors = unique(Totpcpb$`color_Total Precipitation`)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "1990 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 Precipitation"
                            , colors = unique(Totpcpb1$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2000 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 Precipitation"
                            , colors = unique(Totpcpb2$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2010 Precipitation" ){
      
      map3 <- map3 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 Precipitation"
                            , colors = unique(Totpcpb3$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2020 Precipitation" ){
      
      map3 <- map3 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 Precipitation"
                            , colors = unique(Totpcpb4$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  })} # end of observe event
  , options = list(height = 700, width ="800px"))
```


## Block Group {.tabset}

### Variable Description 

A Brief View of the Block Group Level Data for the Eastern Shore Region

```{r}
daymet2a <- filter(daymet2, GEOID == c("510010901001", "511319301002", "510010903001", "511319302002"))
kbl(daymet2a) %>%
  kable_paper(full_width = F)  %>% 
   scroll_box(width = "800px", height = "300px")
```

### Summaries 

Summary of the Eastern Shore Region Block Group Level Data

```{r}
daymet2 %>%  dplyr::select(-c(STATEFP:Year, June:August, Totpcp)) %>% 
   dplyr::select(where(~is.numeric(.x) && !is.na(.x))) %>% 
  as.data.frame() %>% 
  stargazer(., type = "text", title = "Summary Statistics", digits = 0,
            summary.stat = c("mean", "sd", "min", "median", "max"))
```


##  Block Group Maps 

Variation Across Blocks Groups 

The goal of the project is to identify the effects of climate change on the hot weather patterns in the counties. We chose June, July, August as the months of interest because they represent summer months. We believe they are the hottest months of the year and allows us to observe temperature fluctuations in stable month periods. We also chose 1980, 1990, 2000, 2010, and 2020 as years to explore because of the density of the available data and for clearer understanding of variation over time.

This is an interactive graph. Click on the graph to zoom and click on the counties to see information on the temperature for that location. Click through each year to see the changes in the block group level temperature readings for all counties for each year. 


  
```{r, echo=FALSE}
shinyApp(ui = shiny::fluidPage(
  titlePanel(title = h4("Eastern Shore DAYMET Temperature Data by Block Group: Years: 1980, 1990, 2000, 2010, 2020")),
  mainPanel(
    
    # Output: Tabset w/ plot, summary, and table ----
    tabsetPanel(type = "tabs",
                tabPanel("June Max Temperature", leaflet::leafletOutput( outputId = "map", height = 500, width = "800px")),
                tabPanel("July Max Temperature", leaflet::leafletOutput( outputId = "map1", height = 500, width = "800px")),
                tabPanel("August Max Temperature", leaflet::leafletOutput( outputId = "map2", height = 500, width = "800px")),
                tabPanel("Total Precipitation", leaflet::leafletOutput( outputId = "map3", height = 500, width = "800px")))
  )), 
  
  server = function(input, output){
  
  # render the map
  output$map <- leaflet::renderLeaflet({
    blockmapbg
  })
  
  output$map1 <- leaflet::renderLeaflet({
    blockmapbg1
  })
  output$map2 <- leaflet::renderLeaflet({
    blockmapbg2
  })
  
  output$map3 <- leaflet::renderLeaflet({
    blockmapbg3
  })
  
  #### If statement for Dynamic Leaflet Legend ####
  observeEvent( input$map_groups,{
    
    map <- leafletProxy("map") %>% clearControls()
    
    if( input$map_groups == "1980 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 June"
                            , colors = unique(June$color_June)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "1990 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 June"
                            , colors = unique(June1$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2000 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 June"
                            , colors = unique(June2$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2010 June" ){
      
      map <- map %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 June"
                            , colors = unique(June3$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2020 June" ){
      
      map <- map %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 June"
                            , colors = unique(June4$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  
    # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map1_groups,{
    
    map1 <- leafletProxy("map1") %>% clearControls()
    
    if( input$map1_groups == "1980 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 July"
                            , colors = unique(July$color_July)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "1990 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 July"
                            , colors = unique(July1$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2000 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 July"
                            , colors = unique(July2$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2010 July" ){
      
      map1 <- map1 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 July"
                            , colors = unique(July3$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2020 July" ){
      
      map1 <- map1 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 July"
                            , colors = unique(July4$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map2_groups,{
    
    map2 <- leafletProxy("map2") %>% clearControls()
    
    if( input$map2_groups == "1980 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 August"
                            , colors = unique(August$color_August)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "1990 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 August"
                            , colors = unique(August1$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2000 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 August"
                            , colors = unique(August2$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2010 August" ){
      
      map2 <- map2 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 August"
                            , colors = unique(August3$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2020 August" ){
      
      map2 <- map2 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 August"
                            , colors = unique(August4$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map3_groups,{
    
    map3 <- leafletProxy("map3") %>% clearControls()
    
    if( input$map3_groups == "1980 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 Precipitation"
                            , colors = unique(Totpcp$`color_Total Precipitation`)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "1990 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 Precipitation"
                            , colors = unique(Totpcp1$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2000 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 Precipitation"
                            , colors = unique(Totpcp2$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2010 Precipitation" ){
      
      map3 <- map3 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 Precipitation"
                            , colors = unique(Totpcp3$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2020 Precipitation" ){
      
      map3 <- map3 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 Precipitation"
                            , colors = unique(Totpcp4$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
} # end of server
, options = list(height = 700, width ="800px"))
```

## Tracts {.tabset}

### Variable Description 

A Brief View of the Tract Level Data for the Eastern Shore Region 

```{r}
daymet3a <- filter(daymet3, GEOID == c("51003010100", "51003011400", "51065020101", "51065020300", "51079030101", "51079030200", "51109950100", "51109950500", "51125950100", "51125950300", "51540000201", "51540001000"))
kbl(daymet3a) %>%
  kable_paper(full_width = F)  %>% 
   scroll_box(width = "800px", height = "300px")
```

### Summaries 

Summary of the Eastern Shore Region Tract Level Data

```{r}
daymet3 %>%  dplyr::select(-c(STATEFP:Year, June:August, Totpcp)) %>% 
   dplyr::select(where(~is.numeric(.x) && !is.na(.x))) %>% 
  as.data.frame() %>% 
  stargazer(., type = "text", title = "Summary Statistics", digits = 0,
            summary.stat = c("mean", "sd", "min", "median", "max"))
```


## Tract Maps 

Variation Across Tracts

The goal of the project is to identify the effects of climate change on the hot weather patterns in the counties. We chose June, July, August as the months of interest because they represent summer months. We believe they are the hottest months of the year and allows us to observe temperature fluctuations in stable month periods. We also chose 1980, 1990, 2000, 2010, and 2020 as years to explore because of the density of the available data and for clearer understanding of variation over time.

This is an interactive graph. Click on the graph to zoom and click on the counties to see information on the temperature for that location. Click through each year to see the changes in the track level temperature readings for all counties for each year. 


```{r, echo=FALSE}
shinyApp(ui = shiny::fluidPage(
  titlePanel(title = h4("Eastern Shore DAYMET Temperature Data by Tracts: Years: 1980, 1990, 2000, 2010, 2020")),
  mainPanel(
     
    # Output: Tabset w/ plot, summary, and table ----
    tabsetPanel(type = "tabs",
                tabPanel("June Max Temperature", leaflet::leafletOutput( outputId = "map", height = 500, width = "800px")),
                tabPanel("July Max Temperature", leaflet::leafletOutput( outputId = "map1", height = 500, width = "800px")),
                tabPanel("August Max Temperature", leaflet::leafletOutput( outputId = "map2", height = 500, width = "800px")),
                tabPanel("Total Precipitation", leaflet::leafletOutput( outputId = "map3", height = 500, width = "800px")))
  ))
, 

server = function(input, output){
  
  
  # render the map
  output$map <- leaflet::renderLeaflet({
    blockmapt
  })
  
  output$map1 <- leaflet::renderLeaflet({
    blockmapt1
  })
  output$map2 <- leaflet::renderLeaflet({
    blockmapt2
  })
  
  output$map3 <- leaflet::renderLeaflet({
    blockmapt3
  })
  
  #### If statement for Dynamic Leaflet Legend ####
  observeEvent( input$map_groups,{
    
    map <- leafletProxy("map") %>% clearControls()
    
    if( input$map_groups == "1980 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 June"
                            , colors = unique(Junet$color_June)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "1990 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 June"
                            , colors = unique(Junet1$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2000 June" ){
      
      map <- map %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 June"
                            , colors = unique(Junet2$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2010 June" ){
      
      map <- map %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 June"
                            , colors = unique(Junet3$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map_groups == "2020 June" ){
      
      map <- map %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 June"
                            , colors = unique(Junet4$color_June)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  
    # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map1_groups,{
    
    map1 <- leafletProxy("map1") %>% clearControls()
    
    if( input$map1_groups == "1980 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 July"
                            , colors = unique(Julyt$color_July)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "1990 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 July"
                            , colors = unique(Julyt1$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2000 July" ){
      
      map1 <- map1 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 July"
                            , colors = unique(Julyt2$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2010 July" ){
      
      map1 <- map1 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 July"
                            , colors = unique(Julyt3$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map1_groups == "2020 July" ){
      
      map1 <- map1 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 July"
                            , colors = unique(Julyt4$color_July)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map2_groups,{
    
    map2 <- leafletProxy("map2") %>% clearControls()
    
    if( input$map2_groups == "1980 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 August"
                            , colors = unique(Augustt$color_August)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "1990 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 August"
                            , colors = unique(Augustt1$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2000 August" ){
      
      map2 <- map2 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 August"
                            , colors = unique(Augustt2$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2010 August" ){
      
      map2 <- map2 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 August"
                            , colors = unique(Augustt3$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map2_groups == "2020 August" ){
      
      map2 <- map2 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 August"
                            , colors = unique(Augustt4$color_August)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
  observeEvent( input$map3_groups,{
    
    map3 <- leafletProxy("map3") %>% clearControls()
    
    if( input$map3_groups == "1980 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1980 Precipitation"
                            , colors = unique(Totpcpt$`color_Total Precipitation`)
                            , opacity = 1
                            , labels = c( "70 - 75"
                                          , "75.1 - 80"
                                          , "80.1 - 85"
                                          , "85.1 - 90"
                                          , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "1990 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "1990 Precipitation"
                            , colors = unique(Totpcpt1$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2000 Precipitation" ){
      
      map3 <- map3 %>%
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2000 Precipitation"
                            , colors = unique(Totpcpt2$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2010 Precipitation" ){
      
      map3 <- map3 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2010 Precipitation"
                            , colors = unique(Totpcpt3$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" )
      
    } else if( input$map3_groups == "2020 Precipitation" ){
      
      map3 <- map3 %>%  
        
        leaflet::addLegend( position = "bottomright"
                            , title = "Legend"
                            , group = "2020 Precipitation"
                            , colors = unique(Totpcpt4$`color_Total Precipitation`)
                            , opacity = 1
                            ,  labels = c( "70 - 75"
                                           , "75.1 - 80"
                                           , "80.1 - 85"
                                           , "85.1 - 90"
                                           , "90.1 - 95" ) ) %>%
        addControl( html = mapTitle
                    , position = "topleft" ) 
      
    }  # end of if else statements
  }) # end of observe event
  
} # end of server
, options = list(height = 700, width ="800px"))
```
